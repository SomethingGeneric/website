<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><title>Astro</title><style>body{background-color:#000;color:#0f0;font-family:Courier New,Courier,monospace}a{color:#0f0}
</style></head> <body>  <h1 id="week-4-class-on-21224">Week 4 (Class on 2/12/24)</h1>
<h2 id="exploiting-cupcake---notes">Exploiting Cupcake - Notes</h2>
<ol>
<li>
<p>How you determined the versions of the two services exposed by cupcake</p>
<p>Luckily, the version of services running on cupcake were found simply by the nmap scan.</p>
</li>
<li>
<p>How you dealt with parsing nmap result with nmaptocsv</p>
<p>nmaptocsv worked just fine as documented.</p>
</li>
<li>
<p>The techniques you used to invoke remote code execution</p>
<p>Invoking RCE on cupcake was using the <code>/status</code> page which is a CGI script hosted by apache.
I used <code>nmap</code> syntax and a <code>--script</code> argument, or <code>curl</code> syntax like the below, rather than the code listed on the CVE’s <a href="https://www.exploit-db.com/exploits/34900">exploitdb</a> page.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#E1E4E8">RUN_ON_HOST</span><span style="color:#F97583">=</span><span style="color:#9ECBFF">"cat /etc/issue"</span></span>
<span class="line"><span style="color:#B392F0">curl</span><span style="color:#79B8FF"> -H</span><span style="color:#9ECBFF"> "User-Agent: () { : ; }; echo; </span><span style="color:#E1E4E8">$RUN_HOST</span><span style="color:#9ECBFF">"</span><span style="color:#9ECBFF"> http://10.0.5.23/cgi-bin/status</span></span>
<span class="line"></span></code></pre>
</li>
<li>
<p>The generation of a list of passwords and subsequent ssh bruteforce</p>
<p>The creation of a wordlist and usage of hydra worked fine as in the documentation.</p>
</li>
<li>
<p>Transfer of files using python and wget or any other mechanism you chose</p>
<p>I mostly used <code>scp</code> once I had the SSH password. I managed to not need to move files to the host with the CGI rce.</p>
</li>
<li>
<p>Compiling and running a privilege escalation exploit (It can be different than the demo!)</p>
<p>The instructions in the <a href="https://www.exploit-db.com/exploits/40839">Dirty Cow</a> exploit worked just as described.</p>
</li>
</ol>
<h2 id="exploiting-cupcake---reflection">Exploiting Cupcake - Reflection</h2>
<p>The big learning experience for me is that a user which doesn’t have that many permissions could still see <code>/etc/passwd</code>, and thus you can easily get valid usernames, even with a fairly well-sandboxed service.</p>
<p>Of course, in the real world, we wouldn’t be able to guess that the password to a found account would be in the default <code>rockyou</code> without any permutation.</p>
<p>Overall, the tools used in this activity were mostly ones I had used before, but I wouldn’t have considered the overall path that took us from 0 - pwn.</p>  </body></html>